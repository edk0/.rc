#!/usr/bin/env es

tar tf $1 | {
	line = <={%read}
	prefix = <={~~ $line */}
	!result $#prefix && !grep -vqF $prefix ^ '/' && echo extracting to $prefix >[2=1]
} && tar xf $1 || {
	(name _) = <={~~ $1 *.tar.* *.*}
	if {result $#name} {
		echo can\'t work out the name >[2=1]
		exit 1
	}
	mkdir $name || exit 1
	echo extracting to $name >[2=1]
	tar -C $name -xf $1
}
